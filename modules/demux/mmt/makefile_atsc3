all: intermediate libatsc3_core unit_tests listener_tests
clean:
	rm -f *.o
	
intermediate: xml.o atsc3_utils.o atsc3_lls.o
libatsc3_core: libatsc3.o
unit_tests: atsc3_lmt_test atsc3_lls_slt_parser_test atsc3_lls_test atsc3_lls_SystemTime_test
listener_tests: atsc3_lls_listener_test

#intermediate object gen

xml.o: xml.c xml.h
	cc -g -c xml.c 
	
atsc3_utils.o: atsc3_utils.h atsc3_utils.c
	cc -g -c atsc3_utils.c
	
atsc3_lls.o: atsc3_utils.h atsc3_lls.h atsc3_lls.c
	cc -g -c atsc3_lls.c
	
#core libatsc3 library gen

libatsc3.o: xml.o atsc3_utils.o atsc3_lls.o
	ld -o libatsc3.o -r xml.o atsc3_utils.o atsc3_lls.o 

#unit test generation

atsc3_lmt_test: atsc3_lmt_test.c libatsc3.o
	cc -g atsc3_lmt_test.c libatsc3.o -lz -o atsc3_lmt_test
			  
atsc3_lls_test: atsc3_lls_test.c libatsc3.o
	cc -g atsc3_lls_test.c libatsc3.o -lz -o atsc3_lls_test
		   		   
atsc3_lls_slt_parser_test: atsc3_lls_slt_parser_test.c libatsc3.o
	cc -g atsc3_lls_slt_parser_test.c libatsc3.o -lz -o atsc3_lls_slt_parser_test 

atsc3_lls_SystemTime_test: atsc3_lls_SystemTime_test.c libatsc3.o
	cc -g atsc3_lls_SystemTime_test.c libatsc3.o -lz -o atsc3_lls_SystemTime_test 

#integration tests

atsc3_lls_listener_test: atsc3_lls_listener_test.c libatsc3.o
	cc -g atsc3_lls_listener_test.c libatsc3.o -lz -lpcap -o atsc3_lls_listener_test
